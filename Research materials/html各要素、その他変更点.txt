# 依頼
- /imagesフォルダのクリックさせる画像認識から、クリックさせる該当のポジションをPythonのSeleniumを使って、以下の各種要素を叩く処理に変更してください。
- 上記以外においても、「処理手順変更」がある場合は処理の順番にしてがって記述していますので、併せて変更してください。
- 以上の変更に関わる全てのファイルのscriptの修正をしてください。

# 補足
- 実際にクリックしていく順番に並べてます
- 各要素一番上に、自動クリック処理において、置き換える前の特定の場所を認識させる要素を添えてます。
- 各自動操作の前後に、2秒の待機時間を設けること。

# 各種要素

## 1
image1.png
【ログインボタン】
<a class="styles_loginButton_XULR9 styles_module_dj3sD" role="button" data-theme="primary">ログイン</a>

記録:
- タグ名: a
- id: (なし)
- class: styles_loginButton_XULR9 styles_module_dj3sD
- テキスト: ログイン
- XPath候補: //*[@id="__next"]/div/main/div[2]/div[2]/a


## 2
image2.png
【ユーザー名入力欄】
<input type="text" name="username" value id="account" class="chkrequired after" autocomplete="off" placeholder="AirIDまたはメールアドレス">

記録:
- タグ名: input
- id: account
- name: username
- type: text
- XPath候補: //*[@id="account"]


## 3
tabキー1回押す
【パスワード入力欄】
<input type="password" name="password" id="password" class="chkrequired js-password after" value placeholder="パスワード" autocomplete="off">

記録:
- タグ名: input
- id: password
- name: password
- type: password
- XPath候補: //*[@id="password"]


## 4
tabキー2回押す + enter
【ログインボタン（2回目）】
<input type="submit" value="ログイン" class="primary" autocomplete="off">

記録:
- タグ名: input
- id: (なし)
- class: primary
- テキスト: ログイン
- XPath候補: //*[@id="mainContent"]/div/div[2]/div[4]/input


## 5
image3.png
【「応募者」リンク】
<a class="styles_menulink _TTEe" aria-disabled="false" href="/entries">応募者</a>

記録:
- タグ名: a
- id: (なし)
- class: styles_menulink _TTEe
- テキスト: 応募者
- XPath候補: //*[@id="__next"]/header/div/nav/ul/li[3]/a


## 6
image4.png
【選択メニュー要素】
<select name="selectionStatus" data-select="selectBox" class="styles_module__EA2he styles_selectStatus__of50a" data-theme="button"></select>

記録:
- タグ名: select
- id: (なし)
- name: selectionStatus
- class: styles_module__EA2he styles_selectStatus__of50a
- テキスト: (なし)
- XPath候補: //*[@id="applicationList"]/form/div/select[1]


## 7
image5.png
【選択肢: 未対応】
<option value="01" class="styles_module__EA2he">未対応</option>

記録:
- タグ名: option
- id: (なし)
- class: styles_module__EA2he
- value: 01
- テキスト: 未対応
- XPath候補: //*[@id="applicationList"]/form/div/select[1]/option[2]


## 8
image6.png 右側クリック
【検索ボタン】*1回目
<button type="button" class="styles_searchButton__aRKjk styles_module__kr35h" data-theme="normal" data-la="entries_search_btn_click">検索</button>

記録:
- タグ名: button
- id: (なし)
- class: styles_searchButton__aRKjk styles_module__kr35h
- テキスト: 検索
- XPath候補: //*[@id="applicationList"]/form/div/button


## 9
image7.png
【ダウンロードボタン】
<button class="styles_module__kr35h" data-theme="normal" data-la="entries_download_btn_click">応募者一覧をダウンロードする（上限1000件）</button>

記録:
- タグ名: button
- id: (なし)
- class: styles_module__kr35h
- テキスト: 応募者一覧をダウンロードする（上限1000件）
- XPath候補: //*[@id="footerWrapper"]/section/div[1]/button



##補足
当該のタイミングおよび以後も「wait_image_1.png」は不要　(outlookmail_送付フォーマット.xlsxを開かなくなったため)



## 10
image6.png 左側クリック
【検索ボックス】
<input type="text" name="searchWord" placeholder="雇用形態 勤務地 職種名/番号 応募者名" maxlength="120" aria-label="フリーワード検索" class="styles_textBox__otPE styles_module__MIr1v">

記録:
- タグ名: input
- id: (なし)
- name: searchWord
- type: text
- placeholder: 雇用形態 勤務地 職種名/番号 応募者名
- XPath候補: //*[@id="applicationList"]/form/div/input



## 11
image6.png 右側クリック
【検索ボタン】*2回目
<button type="button" class="styles_searchButton__aRKjk styles_module__kr35h" data-theme="normal" data-la="entries_search_btn_click">検索</button>

記録:
- タグ名: button
- id: (なし)
- class: styles_searchButton__aRKjk styles_module__kr35h
- テキスト: 検索
- XPath候補: //*[@id="applicationList"]/form/div/button


## 12
image8.png 左側クリック
【応募者別：対応状況セル】
<td class="styles_tdSelectionStatus__NLUd styles_td_f7lbf" ...>
    ... (内部に <select> や <memo> ボタンなどを含む)
</td>

記録:
- タグ名: td
- id: (なし)
- class: styles_tdSelectionStatus__NLUd styles_td_f7lbf
- テキスト: (なし / またはセルの内容全体)
- XPath候補: //td[contains(@class, 'styles_tdSelectionStatus')]

### 補足
（開発者ツールのカーソルが「未対応」枠（<select>要素）を囲む親要素（緑枠に対応する部分、おそらく<td>タグ）に当たっており、その要素情報がポップアップで表示されていますね。この親要素をクリックさせることは可能です。この親要素は、その行全体の「対応状況」のセルを表しており、要素をクリックさせたい場合、この要素の情報を記録する必要があります。🖱️ 親要素（緑枠）の記録情報ポップアップに表示されている情報と、その行の要素から情報を抽出します。要素: 対応状況のセル全体 (おそらく <td> タグ)クラス名: $\text{td.styles\_tdSelectionStatus\_NLUd...}$ と表示されていることから、この要素は <td> タグであり、クラス名に $\text{styles\_tdSelectionStatus\_NLUd}$ が含まれていることが分かります。🔗 XPath候補の決定（汎用化）この要素も、どの応募者の行にあるセルでも特定できるように、共通のクラス名を使って汎用化します。$$\text{XPath候補 (汎用)}: \text{//td[contains(@class, 'styles\_tdSelectionStatus')]}$$このXPathは、「styles_tdSelectionStatusという部分的なクラス名を含むすべての <td> タグ」を特定します。このXPathを使えば、どの応募者の行の**「対応状況」のセル**でもクリックできるようになります。）


## 13
image9.png
【履歴書を開くボタン】
<a target="_blank" href="..." data-la="entry_detail_resume_btn_click" class="styles_btnResumeFiles___LJd2 styles_module__dj3Sd" role="button" data-theme="normal">レジュメを開く</a>

記録:
- タグ名: a
- id: (なし)
- class: styles_btnResumeFiles___LJd2 styles_module__dj3Sd
- テキスト: レジュメを開く
- XPath候補: //a[@data-la='entry_detail_resume_btn_click']
（ XPath候補の決定（汎用化）この要素は、URL（href）に応募者固有のIDが含まれているため、「未対応」と同様に全応募者で共通の属性をターゲットにします。この要素で最も安定した共通属性は、**data-la**属性です。$$\text{XPath候補 (汎用)}: \text{//a[@data-la='entry\_detail\_resume\_btn\_click']}$$）


補足：wait_image_2.png 不要


## 14
【処理手順変更】
変更前：右クリック　→　image10.pngをクリック　→　enter
変更後：右クリック　→　「ｓ」キー一回プッシュ　→　enter 2回プッシュ



## 補足
以下の待機用画像は不要（メール送信、ファイル添付手段を変更したため）
- wait_image_3.png
- wait_image_4.png
- wait_image_5.png
- wait_image_6.png
- wait_image_7.png
- wait_image_8.png



## 15
image12.png
【閉じるボタン】
<img alt="閉じる" data-la="overlay_entry_detail_close_btn_click" src="/_next/static/media/close.d4f79a28.svg" decoding="async" data-nimg="intrinsic" style="...">

記録:
- タグ名: img
- id: (なし)
- class: (なし)
- テキスト: 閉じる
- XPath候補: //img[@data-la='overlay_entry_detail_close_btn_click']
（XPath候補の決定（汎用化）このボタンはidやclassがなく、data-la属性が明確な識別子となっています。これを汎用的なXPathのターゲットとして使用します。$$\text{XPath候補 (汎用)}: \text{//img[@data-la='overlay\_entry\_detail\_close\_btn\_click']}$$）



## 16
image8.png 右側クリック
【各応募者リストの「未対応」フラグ】
<select data-select="selectBoxTable" ... (長い属性は省略) ... class="styles_module__EA2he styles_selectbox__6p0hQ" ...></select>

記録:
- タグ名: select
- id: (なし)
- class: styles_module__EA2he styles_selectbox__6p0hQ
- data属性: data-select="selectBoxTable"
- XPath候補: //select[@data-select='selectBoxTable']
（このXPathを使えば、どの応募者の行にある「未対応」ボタン（<select>要素）も、共通の属性によって特定できます。）Geminiより



## 17
image13.png
【選択肢: 面接調整開始】
<option value="04" class="styles_module__EA2he">面接調整開始</option>

記録:
- タグ名: option
- id: (なし)
- class: styles_module__EA2he
- value: 04
- テキスト: 面接調整開始
- XPath候補: //select[@data-select='selectBoxTable']//option[@value='04']
（✅ 修正後のXPath候補（より安全な指定）
安全性を高めるため、親要素である応募者ごとの「未対応」フラグ（<select>タグ）の中に限定するXPathを提案します。このXPathは、応募者リストの<select>要素の中にある value="04" の<option>要素のみを対象とするため、誤クリックを防ぐのに役立つはずです。）
（応募者ごとの「未対応」ボタン）の中のこの<option>タグを選ぶ動作を促すことが期待できます。）