# Codex 操作ガイドライン（Agent.md）

このプロジェクトにおいて Codex がコードを編集する際は、以下のルールを必ず守ること。

## 【出力言語に関する規則】
- Codex が返すメッセージ、変更内容の説明、ログはすべて日本語で出力すること。
- 英語で説明する必要がある場合でも、日本語の補足を必ず付けること。

## 【方針・原則】
- 指示は、チャット上とは別に、"airwork-project\ToDo"フォルダに納められた"prompt"ファイルを渡す場合もあります。
- ユーザーからの明確な指示がない限り、推測で行動してはならない。
- 操作の曖昧な箇所がある場合、何もせずにユーザーに確認を求めること。
- 確認を求める場合は、ユーザーが理解しやすい選択しも出すこと。
- ユーザーが選択肢から選んだ方針に忠実に行動すること。
- エラーが起きた際は、(ログ("airwork-project\program\logs")や、参考資料("airwork-project\Research materials")をもとに)原因を突き止めて説明し、修正方法を提示すること。
- ユーザーからファイル書き換えの指示を受けた時は、"airwork-project\Research materials"に納められた以下のファイルを参照(または模倣)してください。_
また、同ディレクトリに納められている他の資料ファイルも必要に応じて参考にすること。
### 対象ファイル
- \bak-new_automation.py (当ファイルを「バックアップファイル」という名前で指す)
- \airwork_selenium_sample.py (当ファイルを「サンプルファイル」という名前で指す)


## 【許可される操作】
1. 当プロジェクトで基本的にAIにスクリプトの編集をさせるのは以下のファイルのみ。
### 対象ファイル
- airwork-project\program\new_automation.py (当ファイルを「メインファイル」という名前で指す)
- airwork-project\program\config.yaml (当ファイルを「config」という名前で指す)
- airwork-project\program\requirements.txt (当ファイルを「requirements」という名前で指す)
2. ただし、ユーザーが直接明示してファイル編集の許可をした場合は、その限りではない。
3. 明示的な指示がある場合に限り、新しい関数の追加やコード整理を行ってよい。
4. コメントやドキュメントの追加など、挙動に影響を与えず、ただコードの可読性向上させる場合は許可する。
5. 編集内容を、実行前に必ずユーザーに報告して確認を求めること。

## 【自動実行ルール（手動承認は /apply のみ）】
- 指示を受けたら、まず編集対象の全体構造を把握し、影響範囲を整理する。
- 修正方針と変更点を「日本語で説明文つきの diff」として提示する。
- ユーザーが/diff を提示したら、以下の処理をすること。
- /deffを確認したら、自身の判断で：
    - 対象ファイルへ修正を反映
    - 保存
    - git add .
    - 必要に応じて git commit -m "<わかりやすい日本語ログ>"
  を自動で実行する。
- 作業中に不要な承認ダイアログや「進めて良いですか？」といった確認は絶対に出さない。
- 人間が離席していても作業が止まらないよう、承認後の処理はすべて全自動で完了させる。


## 【禁止される操作】
1. ユーザーが指定していないファイルの編集、新規作成、削除、移動は禁止。
2. ディレクトリ構造を勝手に変更してはならない。
3. secrets.yaml、config.enc、または機密情報を含む可能性のあるファイルには一切触れてはならない。
4. 外部APIキーやパスワードを生成、変更、参照してはならない。
5. バッチファイル（.bat）の上書きや削除は禁止。
6. /apply を必要としない状態でファイルを直接書き換えない。
7. 不必要な中間確認を出さない。


## 【特記事項】
- このプロジェクトは Windows、Python、Selenium、PyAutoGUI を使用している。  
  これらの動作に関わるパス、ウィンドウ操作、画像座標などはユーザーが明示した場合のみ変更してよい。
- Excelテンプレート（outlookmail_送付フォーマット.xlsx）は構造（列名）を変更してはならない。

## 【出力言語の強制】
- Codex は説明文、提案、変更内容のログを必ず日本語で出力すること。英語だけの出力は禁止する。
- Codex はすべての説明文・要約・ログを日本語で出力すること。英語のみで説明することは禁止する。